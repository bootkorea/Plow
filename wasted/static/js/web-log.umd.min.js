!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).CoupangWebLog=e()}(this,(function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(H){i(H)}}function s(t){try{c(r["throw"](t))}catch(H){i(H)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))}function o(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),"throw":s(1),"return":s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r["return"]:s[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(H){s=[6,H],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}"function"==typeof SuppressedError&&SuppressedError;var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}function s(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var c={exports:{}};
/*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.2+97478eb6
   */!function(t,e){t.exports=function(){function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var n=void 0;n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var r=n,o=0,a=void 0,c=void 0,u=function(t,e){T[o]=t,T[o+1]=e,2===(o+=2)&&(c?c(E):L())};function p(t){c=t}function f(t){u=t}var d="undefined"!=typeof window?window:undefined,l=d||{},m=l.MutationObserver||l.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),g="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){return function(){return process.nextTick(E)}}function y(){return void 0!==a?function(){a(E)}:S()}function w(){var t=0,e=new m(E),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function b(){var t=new MessageChannel;return t.port1.onmessage=E,function(){return t.port2.postMessage(0)}}function S(){var t=setTimeout;return function(){return t(E,1)}}var T=new Array(1e3);function E(){for(var t=0;t<o;t+=2)(0,T[t])(T[t+1]),T[t]=undefined,T[t+1]=undefined;o=0}function P(){try{var t=s("vertx");return a=t.runOnLoop||t.runOnContext,y()}catch(H){return S()}}var L=void 0;function A(t,e){var n=this,r=new this.constructor(R);r[O]===undefined&&et(r);var o=n._state;if(o){var i=arguments[o-1];u((function(){return z(o,r,i,n._result)}))}else X(n,r,t,e);return r}function I(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(R);return U(n,t),n}L=h?v():m?w():g?b():d===undefined?P():S();var O=Math.random().toString(36).substring(16);function R(){}var _=void 0,C=1,D=2,M=new Y;function x(){return new TypeError("You cannot resolve a promise with itself")}function V(){return new TypeError("A promises callback cannot return that same promise.")}function N(t){try{return t.then}catch(e){return M.error=e,M}}function k(t,e,n,r){try{t.call(e,n,r)}catch(H){return H}}function j(t,e,n){u((function(t){var r=!1,o=k(n,e,(function(n){r||(r=!0,e!==n?U(t,n):B(t,n))}),(function(e){r||(r=!0,W(t,e))}),"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,W(t,o))}),t)}function q(t,e){e._state===C?B(t,e._result):e._state===D?W(t,e._result):X(e,undefined,(function(e){return U(t,e)}),(function(e){return W(t,e)}))}function F(t,n,r){n.constructor===t.constructor&&r===A&&n.constructor.resolve===I?q(t,n):r===M?(W(t,M.error),M.error=null):r===undefined?B(t,n):e(r)?j(t,n,r):B(t,n)}function U(e,n){e===n?W(e,x()):t(n)?F(e,n,N(n)):B(e,n)}function J(t){t._onerror&&t._onerror(t._result),G(t)}function B(t,e){t._state===_&&(t._result=e,t._state=C,0!==t._subscribers.length&&u(G,t))}function W(t,e){t._state===_&&(t._state=D,t._result=e,u(J,t))}function X(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+C]=n,o[i+D]=r,0===i&&t._state&&u(G,t)}function G(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)r=e[a],o=e[a+n],r?z(n,r,o,i):o(i);t._subscribers.length=0}}function Y(){this.error=null}var $=new Y;function K(t,e){try{return t(e)}catch(H){return $.error=H,$}}function z(t,n,r,o){var i=e(r),a=void 0,s=void 0,c=void 0,u=void 0;if(i){if((a=K(r,o))===$?(u=!0,s=a.error,a.error=null):c=!0,n===a)return void W(n,V())}else a=o,c=!0;n._state!==_||(i&&c?U(n,a):u?W(n,s):t===C?B(n,a):t===D&&W(n,a))}function Z(t,e){try{e((function(e){U(t,e)}),(function(e){W(t,e)}))}catch(H){W(t,H)}}var Q=0;function tt(){return Q++}function et(t){t[O]=Q++,t._state=undefined,t._result=undefined,t._subscribers=[]}function nt(){return new Error("Array Methods must be provided an Array")}function nt(){return new Error("Array Methods must be provided an Array")}var rt=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(R),this.promise[O]||et(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&B(this.promise,this._result))):W(this.promise,nt())}return t.prototype._enumerate=function(t){for(var e=0;this._state===_&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===I){var o=N(t);if(o===A&&t._state!==_)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===ut){var i=new n(R);F(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===_&&(this._remaining--,t===D?W(r,n):this._result[e]=n),0===this._remaining&&B(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;X(t,undefined,(function(t){return n._settledAt(C,e,t)}),(function(t){return n._settledAt(D,e,t)}))},t}();function ot(t){return new rt(this,t).promise}function it(t){var e=this;return r(t)?new e((function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))}function at(t){var e=new this(R);return W(e,t),e}function st(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ct(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ut=function(){function t(e){this[O]=tt(),this._result=this._state=undefined,this._subscribers=[],R!==e&&("function"!=typeof e&&st(),this instanceof t?Z(this,e):ct())}return t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype["finally"]=function(t){var e=this,n=e.constructor;return e.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))}))},t}();function pt(){var t=void 0;if(void 0!==i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(H){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(H){}if("[object Promise]"===n&&!e.cast)return}t.Promise=ut}return ut.prototype.then=A,ut.all=ot,ut.race=it,ut.resolve=I,ut.reject=at,ut._setScheduler=p,ut._setAsap=f,ut._asap=u,ut.polyfill=pt,ut.Promise=ut,ut}()}(c);var u=a(c.exports),p=/MSIE ([0-9]{1,}[\\.0-9]{0,})/,f=/Trident\/(\d)/i,d={isIE:function(){return navigator.userAgent.toLowerCase().indexOf("msie")>-1},isIE11:function(){return"Netscape"===navigator.appName&&navigator.userAgent.search("Trident")>-1},getVersion:function(){var t=-1;return"Microsoft Internet Explorer"===navigator.appName&&null!=p.exec(navigator.userAgent)&&(t=parseFloat(RegExp.$1)),t},hasTridentVersion:function(){return null!==navigator.userAgent.match(f)}},l={isSupported:function(){return!(d.isIE()&&d.getVersion()<=7&&!1===d.hasTridentVersion())},isSupportXMLRequest:function(){return!(d.isIE()&&d.getVersion()<=9)||this.isIE11()},isIE8:function(){return d.isIE()&&8===d.getVersion()},isIE11:d.isIE11,isLowerThanIE10:function(){return d.isIE()&&d.getVersion()<10&&!this.isIE11()}};l.isSupported()&&(u.polyfill(),Date.prototype.toISOString||function(){function t(t){return t<10?"0"+t:t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),!window.addEventListener&&function(t,e,n,r,o,i,a){t[r]=e[r]=n[r]=function(t,e){var n=this;a.unshift([n,t,e,function(t){t.currentTarget=n,t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0},t.target=t.srcElement||n,e.call(n,t)}]),this.attachEvent("on"+t,a[0][3])},t[o]=e[o]=n[o]=function(t,e){for(var n=0,r=void 0;r=a[n];++n)if(r[0]==this&&r[1]==t&&r[2]==e)return this.detachEvent("on"+t,a.splice(n,1)[0][3])},t[i]=e[i]=n[i]=function(t){return this.fireEvent("on"+t.type,t)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),"function"!=typeof Object.assign&&(Object.assign=function(t){if(t===undefined||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==undefined&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}),window.performance&&!window.performance.now&&(Date.now=Date.now||function(){return(new Date).getTime()},window.performance.now=function(){return Date.now()-(performance.timing&&performance.timing.navigationStart||Date.now())}));var m=l.isLowerThanIE10()?function(t,e,n,r){var o="";return o+="[".concat(t,"/").concat(e,"]"),{message:o+=" : ".concat(n),color:null}}:function(t,e,n,r){var o="";return o+="%c[".concat(t,"/").concat(e,"]"),{message:o+=" :  ".concat(n),color:r="color: ".concat(r,";")}},h={isDebugEnabled:!1,setDebugMode:function(){this.isDebugEnabled=!0},d:function(t,e){if(window.console&&this.isDebugEnabled){var n=m("Debug",t,e,"purple");n.color?console.log(n.message,n.color):console.log(n.message)}},i:function(t,e){if(window.console&&this.isDebugEnabled){var n=m("Info",t,e,"green");n.color?console.info(n.message,n.color):console.info(n.message)}},w:function(t,e){if(window.console&&this.isDebugEnabled){var n=m("Warn",t,e,"orange");n.color?console.warn(n.message,n.color):console.warn(n.message)}},e:function(t,e){if(window.console&&this.isDebugEnabled){var n=m("Error",t,e,"red");n.color?console.error(n.message,n.color):console.error(n.message)}}},g="WebLogRequester",v="INVALID_PAYLOAD",y="INTERNAL_ERROR",w=l.isSupportXMLRequest(),b=function(){function t(t){var e=t.singleSubmitEndpoint;this.isSupportXMLRequest=w,this.singleSubmitEndpoint=e}return t.prototype.send=function(t){return r(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:h.d(g,"#send - is support 'XMLHttpRequest':".concat(w)),n.label=1;case 1:return n.trys.push([1,6,,7]),!0!==this.isSupportXMLRequest?[3,3]:[4,this.sendXMLHttpRequest(t)];case 2:return[2,n.sent()];case 3:return[4,this.sendXDomainRequest(t)];case 4:return[2,n.sent()];case 5:return[3,7];case 6:throw e=n.sent(),h.e(g,e.message),e;case 7:return[2]}}))}))},t.prototype.sendSync=function(t){var e=new Image,n="record=".concat(encodeURIComponent(JSON.stringify(t)));e.src="".concat(this.singleSubmitEndpoint,"?").concat(n),h.i(g,"#sendLoggingRequest - sendSync : success")},t.prototype.isValidResponse=function(t){var e=(t.responseText?JSON.parse(t.responseText):{}).type;return!(e&&(e===y||e===v))},t.prototype.sendXMLHttpRequest=function(t){var e=this;return new Promise((function(n,r){var o=new XMLHttpRequest,i=e.convertJsonToString(t);o.open("POST",e.singleSubmitEndpoint,!0),o.setRequestHeader("Content-Type","text/plain"),o.onload=function(){var t=o.readyState,i=o.status,a=o.statusText,s=o.responseText;if(t===XMLHttpRequest.DONE&&200===o.status&&e.isValidResponse(o))h.i(g,"#sendXMLHttpRequest - onload\n status: ".concat(i,", statusText: ").concat(a,", responseText: ").concat(s)),n({status:i,statusText:a,responseText:s});else{var c="#sendXMLHttpRequest - onload\n status: ".concat(i,", statusText: ").concat(a,", responseText: ").concat(s);r(new Error(c))}},o.onerror=function(){var t=o.status,e=o.statusText,n=o.responseText,i="#sendXMLHttpRequest - onerror\n status:".concat(t,", statusText: ").concat(e,", responseText: ").concat(n);r(new Error(i))},o.send(i),h.d(g,"#sendXMLHttpRequest - send data \n".concat(i))}))},t.prototype.sendXDomainRequest=function(t){var e=this;return new Promise((function(n,r){var o=new XDomainRequest,i=e.convertJsonToString(t),a=function(){o.onload=null,o.onerror=null,o.ontimeout=null,o.onprogress=null};o.onload=function(){var t=o.responseText;e.isValidResponse(o)?(h.i(g,"#sendXDomainRequest - onload\n responseText: ".concat(t)),n({responseText:t})):r(new Error("#sendXDomainRequest - onload\n responseText: ".concat(t))),a()},o.onerror=function(){r(new Error("#sendXDomainRequest - onerror\n responseText: ".concat(o.responseText))),a()},o.ontimeout=function(){a()},o.onprogress=function(){},o.open("POST",e.singleSubmitEndpoint),o.send(i),h.d(g,"#sendXDomainRequest - send data \n".concat(i))}))},t.prototype.convertJsonToString=function(t){return JSON.stringify(t||{})},t}(),S="AppLogRequester",T=function(){function t(){}return t.prototype.isApp=function(){return this.hasAndroidFunction()||this.hasIOSFunction()},t.prototype.send=function(t){var e=JSON.stringify(t);if(this.hasAndroidFunction())h.d(S,"#send - using window.CoupangAppTracking.logEvent function"),window.CoupangAppTracking.logEvent(e);else{if(!this.hasIOSFunction())return void h.w(S,"#send - Not found App Function.");h.d(S,"#send - using window.webkit.messageHandlers.callBackHandler.postMessage function"),window.webkit.messageHandlers.callBackHandler.postMessage(e)}h.i(S,"#sendToApp - jsonString \n ".concat(e))},t.prototype.hasAndroidFunction=function(){return!(!window.CoupangAppTracking||!window.CoupangAppTracking.logEvent||"function"!=typeof window.CoupangAppTracking.logEvent)},t.prototype.hasIOSFunction=function(){return!!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.callBackHandler&&window.webkit.messageHandlers.callBackHandler.postMessage&&"function"==typeof window.webkit.messageHandlers.callBackHandler.postMessage)},t}(),E=function(){function t(){var t=window.location.href,e=document.referrer||"";this.setPvId(this.generatePvId()),this.setRvId(""),this.setReferrer(e),this.setUrl(t)}return t.prototype.getJSON=function(){var t=this;return{web:{pvid:t.pvid,rvid:t.rvid,url:t.url,referrer:t.referrer}}},t.prototype.generatePvId=function(){var t,e="";for(t=0;t<32;t++){var n=16*Math.random()|0;8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=(12===t?4:16===t?3&n|8:n).toString(16)}return e},t.prototype.setPvId=function(t){this.pvid=t},t.prototype.setRvId=function(t){this.rvid=t},t.prototype.setUrl=function(t){this.url=t},t.prototype.setReferrer=function(t){this.referrer=t},t}(),P=function(t){var e,n=t+"=",r=decodeURIComponent(document.cookie).split(";");for(e=0;e<r.length;e++){for(var o=r[e];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return""},L=function(t,e,n,r,o){var i=new Date(2100,1,1),a=function(t){var e=t.split(".");return 3!==e.length&&4!==e.length?t:t.replace(/^(?:[\w\d]+\.)?([^:/]*).*$/i,"$1")}(decodeURIComponent(document.domain)),s=[];s.push("".concat(t,"=").concat(encodeURIComponent(e))),s.push("; expires=".concat(n&&n.toUTCString()||i.toUTCString())),s.push("; domain=".concat(r||a)),s.push(o&&"; secure"),document.cookie=s.join("")},A="1.4.3",I=function(){function t(){this.setLang().setMemberSrl().setPCID().setResolution().setLibraryVersion(A).setCommonWebParameter(new E)}return t.prototype.setPlatform=function(t){return this.platform=t,this},t.prototype.setEventTime=function(t){return this.eventTime=t,this},t.prototype.setPCID=function(){return this.pcid=P("PCID")||this.generatePCID(),this},t.prototype.setMemberSrl=function(){return this.memberSrl=P("member_srl"),this},t.prototype.setLibraryVersion=function(t){return this.libraryVersion=t,this},t.prototype.setLang=function(){return this.lang=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage,this},t.prototype.setResolution=function(){return this.resolution="".concat(window.screen.width,"x").concat(window.screen.height),this},t.prototype.getJSON=function(){var t=this,e=t.platform,r=t.pcid,o=t.memberSrl,i=t.libraryVersion,a=t.lang,s=t.resolution,c=t.eventTime,u=t.commonWebParameter.getJSON();return{common:n({platform:e,pcid:r,memberSrl:o,libraryVersion:i,lang:a,resolution:s,eventTime:c},u)}},t.prototype.getLibVersion=function(){return A},t.prototype.getExtraWebviewJSON=function(t){var e=this.commonWebParameter.getJSON(),r=n({eventTime:this.eventTime,pcid:this.pcid,libraryVersion:this.getLibVersion()},e.web);if(t){var o=r.url||"",i=r.referrer||"";o.length>100&&(r.url=o.substring(0,100)+"......"),i.length>100&&(r.referrer=i.substring(0,100)+"......")}return r},t.prototype.generatePCID=function(){var t,e=new Date,n=[];return n.push(e.getTime()),n.push(Math.random().toString().substr(2)),L("PCID",t=n.join("").substr(0,23)),t},t.prototype.setCommonWebParameter=function(t){return this.commonWebParameter=t,this},t}(),O=function(){function t(){}return t.prototype.setSchemaId=function(t){return this.schemaId=t,this},t.prototype.setSchemaVersion=function(t){return this.schemaVersion=t,this},t.prototype.getJSON=function(){return{meta:{schemaId:this.schemaId,schemaVersion:this.schemaVersion}}},t}(),R=function(){function t(){this.data={}}return t.prototype.setData=function(t){return this.data=t,this},t.prototype.getJSON=function(){return{data:this.data}},t}(),_=function(){function t(){}return t.prototype.setExtraData=function(t){return this.extraData=t,this},t.prototype.setSentTime=function(t){return this.sentTime=t,this},t.prototype.getJSON=function(){var t=this.sentTime,e=this.extraData;return{extra:n({sentTime:t},e)}},t}(),C={COOKIE:{PCID:"PCID",MEMBERSRL:"member_srl",ISAPP:"ISAPP",CAMPAIGN:["trac_src","trac_spec","trac_sid","trac_lptag","trac_itime","trac_ctag","trac_appver","trac_addtag"]}},D=function(){var t={};return C.COOKIE.CAMPAIGN.map((function(e){var n=e.replace(/^trac\_/,""),r=P(e).replace(/"/g,"");t[n]="0"!==r&&r||""})),t.src&&t.spec&&{campaign:t}||{}},M="ParameterStore",x=function(){function t(){this.store={}}return t.prototype.register=function(t,e){t?void 0!==e?(this.store[t]=e,h.d(M,"#register - data \n".concat(JSON.stringify(e)))):h.w(M,"#register - 'Data is not exist. Can not register data in ".concat(t,".")):h.w(M,"#register - key argument is not exist.")},t.prototype.getRegisteredData=function(t){if(!t)return h.w(M,"#getRegisteredData - key argument is not exist."),null;if("undefined"==typeof this.store[t])return h.w(M,'#getRegisteredData - has not registered data by "'.concat(t,'" key.')),null;var e=this.store[t];return h.d(M,"#getRegisteredData - registered data \n".concat(JSON.stringify(e))),e},t.prototype.findValueFromPath=function(e){var n,r,o;if(e){for(o=e.replace(/"/g,"").replace(t.DYNAMIC_VALUE_FLAG,"").split(t.FIELD_SEPARATOR),r=this.store[o[0]],n=1;n<o.length;n++)void 0===(r=r[o[n]])&&(r="",h.w(M,"#findValueFromPath - found undefined value ".concat(e," > replaced with an empty string."))),h.i(M,"#findValueFromPath - found value ".concat(e,"/").concat(r));return"string"==typeof r?'"'.concat(r,'"'):"object"==typeof r?JSON.stringify(r):r}h.w(M,"#findValueFromPath - path is empty")},t.prototype.replaceDynamicString=function(e){var n=this,r=JSON.stringify(e);return r=r.replace(t.REGEXP_DYNAMIC_VALUE,(function(t){var e=n.findValueFromPath(t);return h.d(M,"#replaceDynamicString - replace string ".concat(t," > ").concat(e)),e})),JSON.parse(r)},t.prototype.merge=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r={},o=!1,i=0,a=e.length;"boolean"==typeof e[0]&&(o=e[0],i++);for(var s=function(e){for(var n in e)o&&"object"==typeof e[n]?r[n]=t.merge(!0,r[n],e[n]):r[n]=e[n]};i<a;i++){s(arguments[i])}return r},t.DYNAMIC_VALUE_FLAG="@",t.REGEXP_DYNAMIC_VALUE=/("@(\w+)(|[.]\w+)+")/g,t.FIELD_SEPARATOR=".",t}(),V="AttrDataUtil",N="data-web-log",k="".concat(N,"-event"),j="".concat(N,"-param"),q=function(){function t(){}return t.prototype.setEvent=function(t,e){e?(t.setAttribute(k,e),h.d(V,"#setEvent - eventType: ".concat(e))):h.w(V,"#setEvent - eventType is empty")},t.prototype.getEvent=function(t){var e=t&&t.getAttribute&&t.getAttribute(k)||"";return h.d(V,"#getEvent - eventType".concat(e?": ".concat(e):" is empty")),e},t.prototype.setRequestParam=function(t,e){if(e)if("string"==typeof e&&0===e.indexOf(x.DYNAMIC_VALUE_FLAG))t.setAttribute(j,e),h.d(V,"#setRequestParam - jsonData: ".concat(e));else{var n=JSON.stringify(e);t.setAttribute(j,n),h.d(V,"#setRequestParam - jsonData: ".concat(n))}else h.w(V,"#setRequestParam - jsonData is empty")},t.prototype.getRequestParam=function(t){var e=t&&t.getAttribute&&t.getAttribute(j)||"{}";return 0===e.indexOf(x.DYNAMIC_VALUE_FLAG)?(h.d(V,"#getRequestParam resister parameter string - \n".concat(e)),e):(h.d(V,"#getRequestParam - \n".concat(e)),JSON.parse(e))},t}(),F=function(t,e){"complete"===document.readyState||"loading"!==document.readyState&&l.isIE8()||"DOMContentLoaded"===t&&"interactive"===document.readyState?window.setTimeout(e):window.addEventListener(t,e)},U=function(){function t(t,e){this.startTime=t,this.optionFields=e}return t.prototype.stop=function(t){this.endTime=t},t.prototype.measureLatency=function(){return Math.floor(this.endTime-this.startTime)},t.prototype.getOptionFields=function(){return this.optionFields},t}();function J(t){return!t||t<0?0:t}var H,B,W,X,G,Y=function(){function t(){}return t.prototype.getNetworkParameters=function(){if(!window.performance||!window.performance.timing)return{};var t=window.performance.timing;return{navigationStart:J(t.navigationStart),redirectStart:J(t.redirectStart),fetchStart:J(t.fetchStart),domainLookupStart:J(t.domainLookupStart),connectStart:J(t.connectStart),secureConnectionStart:J(t.secureConnectionStart),requestStart:J(t.requestStart),responseStart:J(t.responseStart),redirect:J(t.redirectEnd-t.redirectStart)||J(t.fetchStart-t.navigationStart),dns:J(t.domainLookupEnd-t.domainLookupStart),ssl:J(t.connectEnd-t.secureConnectionStart),connect:J(t.connectEnd-t.connectStart),request:J(t.responseStart-t.requestStart),response:J(t.responseEnd-t.responseStart)}},t}(),$="data-load-time",K="TTILog",z=function(){function t(t,e){this.ttiObjects={},this.loadedCount=0,this.asyncLogs=[],this.imageLoadingTime=0,this.latestImageLoadingTime=0,this.webLogRequester=t,this.appLogRequester=e}return t.prototype.init=function(t){var e=t.pageName,n=t.platform,r=t.platformType,o=t.screenType,i=t.extra,a=t.async,s=void 0!==a&&a,c=t.calcType,u=void 0===c?"default":c,p=t.applicationId,f=void 0===p?"no_applicationId_assigned":p;this.commonFields={domain:"tti",logCategory:"system",logType:"performance",eventName:"tti-logger",pageName:e,platformType:r,applicationId:f,ixid:this.generateUUID()},this.baseOption={screenType:o,extra:i,async:s},this.calcType=u||"default",this.commonParameter=(new I).setPlatform(n),this.updatePerformanceValues(s)},t.prototype.record=function(t,e){void 0===e&&(e={});var n=window.performance.now();if(this.ttiObjects.hasOwnProperty(t))return h.w(K,"Already ".concat(t," is recording the TTI"));(e.extra||(e.extra={})).ttiRecordKey=t,e.async=!0,this.ttiObjects[t]=new U(n,e)},t.prototype.stop=function(t){var e=this;if(!this.ttiObjects.hasOwnProperty(t))return h.w(K,"".concat(t," must first record"));var n=this.ttiObjects[t],r=(n.stop(window.performance.now()),delete e.ttiObjects[t],n.measureLatency());this.recordAsync(r,n.getOptionFields())},t.prototype.manualRecord=function(t){void 0===t&&(t={});var e=Math.floor(window.performance.now()),n=Object.assign({},this.baseOption,{async:!0,extra:Object.assign(t,this.baseOption.extra)});this.getLatestImageLoadTime(),this.recordAsync(e,n)},t.prototype.logImageLoadTime=function(t){if(window.performance.getEntriesByName){var e=t.getAttribute("src").replace(/^(\/\/)/,"".concat(location.protocol,"$1")),n=performance.getEntriesByName(e),r=n.length>0&&n[0]||null,o=r&&r.responseEnd||0,i=r&&r.duration||0,a=r&&r.startTime||0,s=o>0?o:a+i;a>0&&s>0&&(t.setAttribute("".concat($,"-start"),a),t.setAttribute("".concat($,"-end"),s))}t.setAttribute($,window.performance.now())},t.prototype.recordAsync=function(t,e){this.asyncLogs.push({tti:t,optionFields:e}),this.domReady&&this.submitAsync()},t.prototype.submitAsync=function(){var t=this;this.asyncLogs.map((function(e){return t.submit(e.tti,Object.assign({serverTime:t.serverTime,domReady:t.domReady,imageLoadingTime:t.imageLoadingTime},e.optionFields))})),this.asyncLogs=[]},t.prototype.submit=function(t,e){var n=this.appLogRequester.isApp(),r=this.makeParams(t,e);n?this.appLogRequester.send(r):this.webLogRequester.send(r),h.d(K,"#submitSync - tti: ".concat(t,", serverTime: ").concat(e.serverTime,", domReady: ").concat(e.domReady,", imageLoadingTime: ").concat(e.imageLoadingTime))},t.prototype.makeParams=function(t,e){var r=n(n(n(n({},(new Y).getNetworkParameters()),{url:location.href}),e.extra),{calcType:this.calcType}),o=(new _).setExtraData(r).setSentTime((new Date).toISOString()).getJSON();return this.commonParameter.setEventTime((new Date).toISOString()),delete e.extra,n(n(n({},this.commonParameter.getJSON()),o),{meta:{schemaId:137,schemaVersion:6},data:Object.assign({tti:t},this.commonFields,e)})},t.prototype.submitSync=function(){if(!this.syncRecorded&&this.domReady){var t=this.domReady;this.imageCount>0&&(t=Math.max(this.domReady,this.latestImageLoadingTime),this.baseOption.extra=Object.assign({latestImageLoadingTime:this.latestImageLoadingTime},this.baseOption.extra)),this.syncRecorded=!0,this.submit(t,Object.assign({serverTime:this.serverTime,domReady:this.domReady,imageLoadingTime:this.imageLoadingTime},this.baseOption))}},t.prototype.getLatestImageLoadTime=function(){for(var t=document.querySelectorAll("img[data-load-time]"),e=this.imageCount=t.length,n=[],r=[],o=0;o<e;o++){var i=Number(t[o].getAttribute($));n.push(t[o].getAttribute("".concat($,"-start"))),r.push(t[o].getAttribute("".concat($,"-end"))),this.latestImageLoadingTime=this.getActualTime(Math.max(this.latestImageLoadingTime,Math.floor(i)))}n.length>0&&r.length>0&&(this.imageLoadingTime=Math.max(0,Math.floor(Math.max.apply(Math,r)-Math.min.apply(Math,n))))},t.prototype.updatePerformanceValues=function(t){var e=this;F("load",(function(){e.supportTimingApi()&&(e.serverTime=Math.max(0,window.performance.timing.responseEnd-window.performance.timing.requestStart),e.domReady=e.getActualTime(window.performance.timing.domContentLoadedEventEnd-window.performance.timing.navigationStart)),e.getLatestImageLoadTime(),!t&&e.submitSync(),e.asyncLogs.length>0&&e.submitAsync()}))},t.prototype.getActualTime=function(t){return"excludeRedirect"===this.calcType&&this.supportTimingApi()&&(t-=window.performance.timing.fetchStart-window.performance.timing.navigationStart),Math.max(0,t)},t.prototype.supportTimingApi=function(){return window.performance&&window.performance.timing},t.prototype.generateUUID=function(){for(var t="",e=0;e<32;e++){var n=16*Math.random()|0;8!==e&&12!==e&&16!==e&&20!==e||(t+="-"),t+=(12===e?4:16===e?3&n|8:n).toString(16)}return t},t}(),Z=Object.freeze({V1:{SINGLE_SUBMIT:"weblog/submit"},V2:{SINGLE_SUBMIT:"api/v2/submit"}}),Q=Object.freeze({KR:{"public":{production:"ljc.coupang.com",integration:"ljc-test.coupang.com",develop:"ljc-test.coupang.com",internal:"ljc.coupangdev.com"},"private":{production:"ljc-private.coupang.net",integration:"ljc-test-private.coupang.net",develop:"ljc-test-private.coupang.net",internal:"ljc.coupangdev.com"}},TW:{"public":{production:"ljc.tw.coupang.com",integration:"ljc-test.tw.coupang.com",develop:"ljc-test.tw.coupang.com",internal:"ljc.coupangdev.com"},"private":{production:"ljc-private.tw.coupang.net",integration:"ljc-test-private.coupang.net",develop:"ljc-test-private.coupang.net",internal:"ljc.coupangdev.com"}}}),tt=function(){function t(t){var e=t.appCode,n=t.host,r=t.market,o=t.mode,i=void 0===o?"production":o,a=t.usePrivateELB,s=t.useV2API;if(this.appCode=e,this.host=n,this.market=r,this.mode=i,this.usePrivateELB=a,this.useV2API=s,n&&!n.startsWith("https://"))throw new Error("host param should be starts with https://")}return t.prototype.getSingleSubmitEndpoint=function(){return this.useV2API?"".concat(this.baseUrl(),"/").concat(Z.V2.SINGLE_SUBMIT,"?appCode=").concat(this.appCode,"&market=").concat(this.market):"".concat(this.baseUrl(),"/").concat(Z.V1.SINGLE_SUBMIT,"/").concat(this.appCode)},t.prototype.baseUrl=function(){if(this.host!==undefined)return this.host;var t=(Q[this.market]||Q.KR)[this.usePrivateELB?"private":"public"];return"https://".concat(t[this.mode]||t.production)},t}(),et=function(){function t(t){this.endpointsConfig=new tt(n({},t))}return t.prototype.resolveEndpoints=function(){return{singleSubmitEndpoint:this.endpointsConfig.getSingleSubmitEndpoint()}},t}(),nt=-1,rt=function(t){addEventListener("pageshow",(function(e){e.persisted&&(nt=e.timeStamp,t(e))}),!0)},ot=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},it=function(){var t=ot();return t&&t.activationStart||0},at=function(t,e){var n=ot(),r="navigate";return nt>=0?r="back-forward-cache":n&&(document.prerendering||it()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:void 0===e?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},st=function(t,e,n){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var r=new PerformanceObserver((function(t){Promise.resolve().then((function(){e(t.getEntries())}))}));return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch(t){}},ct=function(t,e,n,r){var o,i;return function(a){e.value>=0&&(a||r)&&((i=e.value-(o||0))||void 0===o)&&(o=e.value,e.delta=i,e.rating=function(t,e){return t>e[1]?"poor":t>e[0]?"needs-improvement":"good"}(e.value,n),t(e))}},ut=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},pt=function(t){var e=function(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||t(e)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},ft=function(t){var e=!1;return function(n){e||(t(n),e=!0)}},dt=-1,lt=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},mt=function(t){"hidden"===document.visibilityState&&dt>-1&&(dt="visibilitychange"===t.type?t.timeStamp:0,gt())},ht=function(){addEventListener("visibilitychange",mt,!0),addEventListener("prerenderingchange",mt,!0)},gt=function(){removeEventListener("visibilitychange",mt,!0),removeEventListener("prerenderingchange",mt,!0)},vt=function(){return dt<0&&(dt=lt(),ht(),rt((function(){setTimeout((function(){dt=lt(),ht()}),0)}))),{get firstHiddenTime(){return dt}}},yt=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},wt=[1800,3e3],bt={passive:!0,capture:!0},St=new Date,Tt=function(t,e){H||(H=e,B=t,W=new Date,Lt(removeEventListener),Et())},Et=function(){if(B>=0&&B<W-St){var t={entryType:"first-input",name:H.type,target:H.target,cancelable:H.cancelable,startTime:H.timeStamp,processingStart:H.timeStamp+B};X.forEach((function(e){e(t)})),X=[]}},Pt=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var n=function(){Tt(t,e),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,bt),removeEventListener("pointercancel",r,bt)};addEventListener("pointerup",n,bt),addEventListener("pointercancel",r,bt)}(e,t):Tt(e,t)}},Lt=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,Pt,bt)}))},At=[100,300],It=[2500,4e3],Ot={},Rt=function(){function t(t,e){this.performanceObjects={},this.asyncLogs=[],this.webLogRequester=t,this.appLogRequester=e}return t.prototype.submit=function(t,e,n){var r=this.appLogRequester.isApp(),o=this.makeParams(t,e,n);r?this.appLogRequester.send(o):this.webLogRequester.send(o),h.d("PerformanceLog","#submitSync - ".concat(t,": ").concat(e,", serverTime: ").concat(n.serverTime,", domReady: ").concat(n.domReady,", imageLoadingTime: ").concat(n.imageLoadingTime))},t.prototype.makeCommonFields=function(t){return n({logCategory:"system",logType:"performance",eventName:"web_latency_track_log",ixid:this.generateUUID()},t)},t.prototype.makeParams=function(t,e,r){var o,i=this.commonParameter.getJSON().common||{},a=i.pcid,s=i.platform,c=n(n(n(n({},(new Y).getNetworkParameters()),{url:location.href,pcid:a,platform:s}),r.extra),{calcType:this.calcType}),u=(new _).setExtraData(c).setSentTime((new Date).toISOString()).getJSON();return this.commonParameter.setEventTime((new Date).toISOString()),delete r.extra,n(n(n({},this.commonParameter.getJSON()),u),{meta:{schemaId:this.schemaID,schemaVersion:this.schemaVersion},data:Object.assign((o={},o[t]=e,o),this.commonFields,r)})},t.prototype.generateUUID=function(){for(var t="",e=0;e<32;e++){var n=16*Math.random()|0;8!==e&&12!==e&&16!==e&&20!==e||(t+="-"),t+=(12===e?4:16===e?3&n|8:n).toString(16)}return t},t}(),_t=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.schemaID=10797,r.schemaVersion=2,r.fcp=-1,r}return e(n,t),n.prototype.init=function(t){var e=t.pageName,n=t.platform,r=t.platformType,o=t.screenType,i=t.extra,a=t.async,s=void 0!==a&&a,c=t.applicationId,u=void 0===c?"no_applicationId_assigned":c;this.commonFields=this.makeCommonFields({domain:"fcp",pageName:e,platformType:r,applicationId:u}),this.baseOption={screenType:o,extra:i,async:s},this.commonParameter=(new I).setPlatform(n),this.onFCP()},n.prototype.onFCP=function(){var t=this;!function(t,e){e=e||{},yt((function(){var n,r=vt(),o=at("FCP"),i=st("paint",(function(t){t.forEach((function(t){"first-contentful-paint"===t.name&&(i.disconnect(),t.startTime<r.firstHiddenTime&&(o.value=Math.max(t.startTime-it(),0),o.entries.push(t),n(!0)))}))}));i&&(n=ct(t,o,wt,e.reportAllChanges),rt((function(r){o=at("FCP"),n=ct(t,o,wt,e.reportAllChanges),ut((function(){o.value=performance.now()-r.timeStamp,n(!0)}))})))}))}((function(e){console.log("test web-vitals: ","fcp -- ",e),t.fcp=Math.round(e.value)||-1,t.goSubmit()}))},n.prototype.goSubmit=function(e){void 0===e&&(e={}),t.prototype.submit.call(this,"fcp",this.fcp,e)},n}(Rt),Ct=function(t){var e=t.getBoundingClientRect(),n=e.left,r=e.right,o=e.top,i=e.bottom,a=e.width,s=e.height;if(!a||!s)return 0;var c=r>window.innerWidth?window.innerWidth-n:n>=0&&r>=0?a:n<0&&r>=0?r:0,u=i>window.innerHeight?window.innerHeight-o:o>=0&&i>=0?s:o<0&&i>=0?i:0;return Math.max(c*u/(a*s),0)},Dt=new Map([["VIDEO",5],["CANVAS",5],["IMG",2],["SVG",2]]),Mt=["SCRIPT","STYLE","META","HEAD","LINK"],xt="fmp-tag",Vt=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.markCount=0,r.statusObserve=[],r.entries={},r.resolveFn=null,r.rejectFn=null,r.schemaID=10798,r.schemaVersion=1,r.checkMarkStatus(document.body)?r.activeMark():r.passiveMark(),r}return e(n,t),n.prototype.init=function(t){var e=t.pageName,n=t.platform,r=t.platformType,o=t.screenType,i=t.extra,a=t.async,s=void 0!==a&&a,c=t.applicationId,u=void 0===c?"no_applicationId_assigned":c;this.commonFields=this.makeCommonFields({domain:"fmp",pageName:e,platformType:r,applicationId:u}),this.baseOption={screenType:o,extra:i,async:s},this.commonParameter=(new I).setPlatform(n),this.onFMP()},n.prototype.onFMP=function(){var t=this;G=setTimeout((function(){t.getFirstMeaningFulPaint().then((function(e){t.fmp=Math.round(e)||-1,t.fmp>0?t.goSubmit():(clearTimeout(G),t.onFMP())}))["catch"]((function(){t.fmp=-1}))}),200)},n.prototype.getFirstMeaningFulPaint=function(){var t=this;return new Promise((function(e,n){t.resolveFn=e,t.rejectFn=n,"complete"===document.readyState?t.getCoreElement():window.addEventListener("load",(function(){t.getCoreElement()}))}))},n.prototype.checkMarkStatus=function(t){if(!t)return!1;if(t.getAttribute(xt))return!0;for(var e=t.children,n=0;n<e.length;n++){var r=e[n];if(this.checkMarkStatus(r))return!0}return!1},n.prototype.getCoreElement=function(){var t=this;if(!("MutationObserver"in window))return this.rejectFn(),void console.error("browser doesn't support mutationObserver api");this.observe.disconnect(),performance.getEntries().forEach((function(e){t.entries[e.name]=e.responseEnd}));var e=this.getTreeWeight(document.body),n=null;if(e.childList.forEach((function(t){n&&n.weightScore?t.weightScore>n.weightScore&&(n=t):n=t})),n){var r=this.filterEls(n.elementArr);this.resolveFn(this.getElementTiming(r))}else this.resolveFn(0)},n.prototype.activeMark=function(){},n.prototype.passiveMark=function(){var t=this;this.getFirstSnapShot(),this.observe=new MutationObserver((function(){var e=performance.now();t.markCount++,t.statusObserve.push({time:e}),t.setTag(document.body,t.markCount)})),this.observe.observe(document,{childList:!0,subtree:!0})},n.prototype.getFirstSnapShot=function(){var t=performance.now();this.setTag(document.body,this.markCount),this.statusObserve.push({time:t})},n.prototype.getTreeWeight=function(t){if(!t)return null;for(var e=[],n=t.children,r=0;r<n.length;r++){var o=n[r];if(o.getAttribute(xt)){var i=this.getTreeWeight(o);(null==i?void 0:i.weightScore)&&e.push(i)}}return this.calculateScore(t,e)},n.prototype.setTag=function(t,e){var n=t.tagName;if(!(Mt.indexOf(n)>-1))for(var r=t.children,o=0;o<r.length;o++){var i=r[o];if(!i.getAttribute(xt)){if(!Ct(i))continue;i.setAttribute(xt,"".concat(e))}this.setTag(i,e)}},n.prototype.getElementTiming=function(t){var e=this,n=0;return t.forEach((function(t){var r=0;if(1===t.weight){var o=parseInt(t.element.getAttribute(xt),10);r=e.statusObserve[o].time}else if(2===t.weight){if("IMG"===t.element.tagName)r=e.entries[t.element.src];else if("SVG"===t.element.tagName){o=parseInt(t.element.getAttribute(xt),10);r=e.statusObserve[o].time}}else if(5===t.weight)if("VIDEO"===t.element.tagName)r=e.entries[t.element.src];else if("CANVAS"===t.element.tagName){o=parseInt(t.element.getAttribute(xt),10);r=e.statusObserve[o].time}n=Math.max(n,r)})),n},n.prototype.filterEls=function(t){if(1===t.length)return t;var e=0;t.forEach((function(t){e+=t.weightScore}));var n=e/t.length;return t.filter((function(t){return t.weightScore>n}))},n.prototype.calculateScore=function(t,e){var n=t.getBoundingClientRect(),r=n.width,o=n.height,i=Dt.get(t.tagName)||1,a=0;e.forEach((function(t){a+=t.weightScore}));var s=Ct(t)?r*o*i*Ct(t):0,c=[{element:t,weight:i,weightScore:s}];return(s<a||0===s)&&(s=a,c=[],e.forEach((function(t){c=c.concat(t.elementArr)}))),t.setAttribute("fmp_weight","".concat(s)),{weightScore:s,elementArr:c,childList:e,element:t}},n.prototype.goSubmit=function(){t.prototype.submit.call(this,"fmp",this.fmp,{})},n}(Rt),Nt="Expected a function",kt=NaN,jt="[object Symbol]",qt=/^\s+|\s+$/g,Ft=/^[-+]0x[0-9a-f]+$/i,Ut=/^0b[01]+$/i,Jt=/^0o[0-7]+$/i,Ht=parseInt,Bt="object"==typeof i&&i&&i.Object===Object&&i,Wt="object"==typeof self&&self&&self.Object===Object&&self,Xt=Bt||Wt||Function("return this")(),Gt=Object.prototype.toString,Yt=Math.max,$t=Math.min,Kt=function(){return Xt.Date.now()};function zt(t,e,n){var r,o,i,a,s,c,u=0,p=!1,f=!1,d=!0;if("function"!=typeof t)throw new TypeError(Nt);function l(e){var n=r,i=o;return r=o=undefined,u=e,a=t.apply(i,n)}function m(t){var n=t-c;return c===undefined||n>=e||n<0||f&&t-u>=i}function h(){var t=Kt();if(m(t))return g(t);s=setTimeout(h,function(t){var n=e-(t-c);return f?$t(n,i-(t-u)):n}(t))}function g(t){return s=undefined,d&&r?l(t):(r=o=undefined,a)}function v(){var t=Kt(),n=m(t);if(r=arguments,o=this,c=t,n){if(s===undefined)return function(t){return u=t,s=setTimeout(h,e),p?l(t):a}(c);if(f)return s=setTimeout(h,e),l(c)}return s===undefined&&(s=setTimeout(h,e)),a}return e=Qt(e)||0,Zt(n)&&(p=!!n.leading,i=(f="maxWait"in n)?Yt(Qt(n.maxWait)||0,e):i,d="trailing"in n?!!n.trailing:d),v.cancel=function(){s!==undefined&&clearTimeout(s),u=0,r=c=o=s=undefined},v.flush=function(){return s===undefined?a:g(Kt())},v}function Zt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Qt(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&Gt.call(t)==jt}(t))return kt;if(Zt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Zt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(qt,"");var n=Ut.test(t);return n||Jt.test(t)?Ht(t.slice(2),n?2:8):Ft.test(t)?kt:+t}var te,ee=a((function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError(Nt);return Zt(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),zt(t,e,{leading:r,maxWait:e,trailing:o})})),ne={},re={};function oe(t,e){ne[t]=ne[t]||[],ne[t].push(e),function(t){if(re[t])return;if("history"!==(re[t]=!0,t))return;!function(){if(t=window.chrome,e=t&&t.app&&t.app.runtime,n="history"in window&&!!window.history.pushState&&!!window.history.replaceState,e||!n)return;var t,e,n;var r=window.onpopstate;function o(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length>2?e[2]:undefined;if(r){var o=te,i=String(r);te=i,ie("history",{from:o,to:i})}return t.apply(this,e)}}window.onpopstate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=window.location.href,o=te;if(te=n,ie("history",{from:o,to:n}),r)try{return r.apply(this,t)}catch(i){}},ae(window.history,"pushState",o),ae(window.history,"replaceState",o)}()}(t)}function ie(t,e){if(t&&ne[t])for(var n=0,r=ne[t]||[];n<r.length;n++){var o=r[n];try{o(e)}catch(H){}}}function ae(t,e,n){if(e in t){var r=t[e],o=n(r);if("function"==typeof o)try{!function(t,e){var n=e.prototype||{};t.prototype=e.prototype=n,function(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}(t,"__sentry_original__",e)}(o,r)}catch(i){}t[e]=o}}var se=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.schemaID=10943,r.schemaVersion=4,r.reportPageView=ee(r.reportPageView.bind(r),1e3),r}return e(n,t),n.prototype.init=function(t){var e=t.pageName,n=t.platform,r=t.platformType,o=t.screenType,i=t.extra,a=t.async,s=void 0!==a&&a,c=t.applicationId,u=void 0===c?"no_applicationId_assigned":c;this.commonFields=this.makeCommonFields({eventName:"web_page_view",domain:"page view",pageName:e,platformType:r,applicationId:u}),this.baseOption={screenType:o,extra:i,async:s},this.commonParameter=(new I).setPlatform(n),this.startTrackingPageView()},n.prototype.startTrackingPageView=function(){var t=this;this.reportPageView(this.toUrlObj(location.href)),oe("history",(function(e){var n=e.to,r=e.from,o=void 0===r?"":r,i=t.toUrlObj(n);i&&(t.isSameRoute(o,n)||t.reportPageView(i,o))}))},n.prototype.reportPageView=function(t,e){void 0===e&&(e="");var n={path:t.pathname,searchParams:t.searchParams.toString(),origin:t.origin,referrer:e,title:document&&document.title||"",hash:t.hash,viewCount:1,userAgent:"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent};this.submit("url",t.toString(),n)},n.prototype.isSameRoute=function(t,e){var n=window.checkIsSameRouteForPageView||function(t,e){return!1};try{return n(t,e)}catch(H){return!1}},n.prototype.toUrlObj=function(t){if(null==t)return null;try{return new URL(t,location.origin)}catch(H){return null}},n}(Rt),ce=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.schemaID=11778,r.schemaVersion=1,r.lcp=-1,r}return e(n,t),n.prototype.init=function(t){var e=t.pageName,n=t.platform,r=t.platformType,o=t.screenType,i=t.extra,a=t.async,s=void 0!==a&&a,c=t.applicationId,u=void 0===c?"no_applicationId_assigned":c;this.commonFields={domain:"lcp",logCategory:"system",logType:"performance",eventName:"web_latency_track_log",pageName:e,platformType:r,applicationId:u,ixid:this.generateUUID()},this.baseOption={screenType:o,extra:i,async:s},this.commonParameter=(new I).setPlatform(n),this.onLCP()},n.prototype.onLCP=function(){var t=this;!function(t,e){e=e||{},yt((function(){var n,r=vt(),o=at("LCP"),i=function(t){var e=t[t.length-1];e&&e.startTime<r.firstHiddenTime&&(o.value=Math.max(e.startTime-it(),0),o.entries=[e],n())},a=st("largest-contentful-paint",i);if(a){n=ct(t,o,It,e.reportAllChanges);var s=ft((function(){Ot[o.id]||(i(a.takeRecords()),a.disconnect(),Ot[o.id]=!0,n(!0))}));["keydown","click"].forEach((function(t){addEventListener(t,(function(){return setTimeout(s,0)}),!0)})),pt(s),rt((function(r){o=at("LCP"),n=ct(t,o,It,e.reportAllChanges),ut((function(){o.value=performance.now()-r.timeStamp,Ot[o.id]=!0,n(!0)}))}))}}))}((function(e){t.lcp=Math.round(e.value)||-1,t.goSubmit()}),{reportAllChanges:!0})},n.prototype.goSubmit=function(){t.prototype.submit.call(this,"lcp",this.lcp,{})},n}(Rt),ue=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.schemaID=11779,r.schemaVersion=1,r.fid=-1,r}return e(n,t),n.prototype.init=function(t){var e=t.pageName,n=t.platform,r=t.platformType,o=t.screenType,i=t.extra,a=t.async,s=void 0!==a&&a,c=t.applicationId,u=void 0===c?"no_applicationId_assigned":c;this.commonFields={domain:"fid",logCategory:"system",logType:"performance",eventName:"web_latency_track_log",pageName:e,platformType:r,applicationId:u,ixid:this.generateUUID()},this.baseOption={screenType:o,extra:i,async:s},this.commonParameter=(new I).setPlatform(n),this.onFID()},n.prototype.onFID=function(){var t=this;!function(t,e){e=e||{},yt((function(){var n,r=vt(),o=at("FID"),i=function(t){t.startTime<r.firstHiddenTime&&(o.value=t.processingStart-t.startTime,o.entries.push(t),n(!0))},a=function(t){t.forEach(i)},s=st("first-input",a);n=ct(t,o,At,e.reportAllChanges),s&&pt(ft((function(){a(s.takeRecords()),s.disconnect()}))),s&&rt((function(){var r;o=at("FID"),n=ct(t,o,At,e.reportAllChanges),X=[],B=-1,H=null,Lt(addEventListener),r=i,X.push(r),Et()}))}))}((function(e){t.fid=Math.round(e.value)||-1,t.goSubmit()}),{reportAllChanges:!0})},n.prototype.goSubmit=function(){t.prototype.submit.call(this,"fid",this.fid,{})},n}(Rt),pe="WebLog",fe=["click","mouseenter","mouseleave","hold","scroll","swipe","keyup","keydown"],de="data-app-code",le="data-host",me="data-platform",he="data-market",ge="data-service",ve="data-mode",ye="data-auto-send-pageview",we="data-private-elb",be="data-tti",Se="data-v2-api",Te="data-fmp",Ee="data-auto-send-spa-pageview",Pe=["coupang.net","coupangdev.com"],Le=function(){function t(){var t=document.getElementById("coupang-web-log");if(t&&!window.CoupangWebLog){var e={reportSpaPageViewLog:t.getAttribute(Ee)},n={appCode:t.getAttribute(de)||undefined,host:t.getAttribute(le)||undefined,platform:t.getAttribute(me)||"",market:t.getAttribute(he)||undefined,service:t.getAttribute(ge)||"",mode:t.getAttribute(ve)||"production",useAutoSendPageViewLog:"true"===t.getAttribute(ye),usePrivateELB:t.getAttribute(we)||"auto",tti:JSON.parse(t.getAttribute(be)),useV2API:"true"===t.getAttribute(Se),fmp:"true"===t.getAttribute(Te),reportSpaPageViewLog:null===e.reportSpaPageViewLog||"true"===t.getAttribute(Ee)};h.d(pe,"#constructor - use custom attribute(data-platform, data-service, data-mode, data-auto-send-pageview) for initialize"),h.d(pe,"#constructor - initData = ".concat(n)),this.init(n)}else h.d(pe,"#constructor - Not found script tag(#coupang-web-log) for initialize")}return t.prototype.init=function(t){void 0===t&&(t={appCode:"coupang",host:undefined,mode:"production",platform:"web",market:"KR",service:"coupang",useAutoSendPageViewLog:!1,usePrivateELB:"auto",useV2API:!1,reportSpaPageViewLog:!0});var e=t.appCode,r=t.host,o=t.mode,i=t.platform,a=t.market,s=t.service,c=t.useAutoSendPageViewLog,u=t.usePrivateELB,p=t.useV2API,f=t.tti;t.fmp;var d=t.reportSpaPageViewLog,l=void 0===d||d;if(p){if(e===undefined)throw new Error("appCode param should be specified when using V2 API.");if(a===undefined)throw new Error("market param should be specified when using V2 API.")}"production"!==o&&h.setDebugMode(),h.d(pe,"#init -\n".concat(JSON.stringify(t,undefined,2)));var m=!u||"auto"===u.toLowerCase()?this.shouldUsePrivateELB():"true"===u;if(this.checkCustomHost(r,m),this.appCode=e!==undefined&&e.length>0?e:s,this.configResolver=new et({appCode:this.appCode,host:r,market:a,mode:o,usePrivateELB:m,useV2API:p}),this.webLogRequester=new b(n({},this.configResolver.resolveEndpoints())),this.appLogRequester=new T,this.attrDataUtil=new q,this.parameterStore=new x,this.campaignParameter=D(),this.platform=this.detectPlatform(i),c&&this.autoSendPageViewLog(),this.bindEvent(fe),f&&!window.ttiSubmit){var g=new z(this.webLogRequester,this.appLogRequester);h.d(pe,"#init - Active 'tti-logger'"),g.init(n({platform:i},f)),window.ttiSubmit=g.manualRecord.bind(g),window.ttiRecord=g.record.bind(g),window.ttiStop=g.stop.bind(g),window.logImageLoadTime=g.logImageLoadTime.bind(g)}try{this.initPerfMetrics(n({platform:i},f)),l&&this.initPageViewLog(n({platform:i},f))}catch(H){console&&console.log&&console.log("initPerfMetrics or initPageViewLog error: ",H)}return this},t.prototype.initPerfMetrics=function(t,e){var n=this;void 0===e&&(e=!1),[{name:"FCP",constructor:_t},{name:"FMP",constructor:Vt},{name:"LCP",constructor:ce},{name:"FID",constructor:ue}].forEach((function(r){var o=r.name,i=r.constructor;(e||"FMP"!==o)&&new i(n.webLogRequester,n.appLogRequester).init(t)}))},t.prototype.initPageViewLog=function(t){new se(this.webLogRequester,this.appLogRequester).init(t)},t.prototype.autoSendPageViewLog=function(){var t=this,e=function(){h.d(pe,"#autoSendPageViewLog - called onLoadListener");var n=document.querySelector("[data-web-log-event=pageview]"),r=t.getRequestParam(n);t.submit(t.parameterStore.replaceDynamicString(r),!0),window.removeEventListener("load",e),h.d(pe,"#autoSendPageViewLog - removeEventListener success")};F("load",e),h.d(pe,"#autoSendPageViewLog - addEventListener success")},t.prototype.registerParameter=function(t,e){this.parameterStore.register(t,e)},t.prototype.getRegisteredParameter=function(t){return this.parameterStore.getRegisteredData(t)},t.prototype.setEvent=function(t,e){this.attrDataUtil.setEvent(t,e)},t.prototype.getEvent=function(t){return this.attrDataUtil.getEvent(t)},t.prototype.setRequestParam=function(t,e){this.attrDataUtil.setRequestParam(t,e)},t.prototype.getRequestParam=function(t){return this.attrDataUtil.getRequestParam(t)},t.prototype.submit=function(t,e){void 0===e&&(e=!1);var n=!1,r=!0;"boolean"==typeof e?n=e:null!==e&&"object"==typeof e&&(n=!!e.isPVLog,r=!!e.isAsync),n?this.submitForPV(t,r):this.submitForEvent(t,r),h.d(pe,"#submit - isPVLog: ".concat(n,", isAsync: ").concat(r))},t.prototype.shouldUsePrivateELB=function(){var t=document.location.protocol.toLowerCase();if("http"===t||"https"===t)for(var e=document.location.hostname||document.location.host.split(":")[0],n=0,r=Pe;n<r.length;n++){var o=r[n];if(e.toLowerCase().endsWith(o))return h.d(pe,"#shouldUsePrivateELB - detected private ELB pageHost: ".concat(e,", privateDomain: ").concat(o)),!0}return!1},t.prototype.checkCustomHost=function(t,e){t!==undefined&&e&&h.d(pe,"#init - private elb won't be used when custom host=".concat(t," is set"))},t.prototype.detectPlatform=function(t){var e=t.trim().toLowerCase(),n=e;return"android"!==e&&"ios"!==e||this.appLogRequester.isApp()||(h.d(pe,"#detectPlatform - detected platform : from ".concat(t," => mweb")),n="mweb"),n},t.prototype.submitForPV=function(t,e){var n,r=this.appLogRequester.isApp();this.commonParameter=this.generateCommonParameter(),this.commonParameter.setEventTime((new Date).toISOString()),n=this.generateRequestJSON(t),h.d(pe,"#submitForPV - isApp: ".concat(r)),r?this.appLogRequester.send(n):e&&this.webLogRequester.send(n)||this.webLogRequester.sendSync(n)},t.prototype.submitForEvent=function(t,e){var n,r=this.appLogRequester.isApp();this.commonParameter||(h.w(pe,"#submitForEvent - this.commonParameter is not initialized (generate common parameter)"),this.commonParameter=this.generateCommonParameter()),this.commonParameter.setEventTime((new Date).toISOString()),this.commonParameter.setMemberSrl(),n=this.generateRequestJSON(t),h.d(pe,"#submitForEvent - isApp: ".concat(r)),r?this.appLogRequester.send(n):e&&this.webLogRequester.send(n)||this.webLogRequester.sendSync(n)},t.prototype.generateCommonParameter=function(){return(new I).setPlatform(this.platform)},t.prototype.generateMetaParameter=function(t){var e=t.schemaId,n=t.schemaVersion;return e&&n||h.w(pe,"#generateMetaParameter - schemaId: ".concat(e,", schemaVersion: ").concat(n)),(new O).setSchemaId(e).setSchemaVersion(n)},t.prototype.generateDataParameter=function(t){return(new R).setData(t)},t.prototype.generateExtraParameter=function(t){return(new _).setExtraData(t).setSentTime((new Date).toISOString())},t.prototype.generateRequestJSON=function(t){var e=t.meta,r=t.data,o=t.extra,i=e?this.generateMetaParameter(e).getJSON():{meta:{}},a=r?this.generateDataParameter(r).getJSON():{data:{}},s=o?this.generateExtraParameter(o).getJSON():{extra:{}},c=this.commonParameter.getJSON();return this.appLogRequester.isApp()&&(s.$webview=this.commonParameter.getExtraWebviewJSON(!0)),n(n(n(n(n({},c),i),a),s),this.campaignParameter)},t.prototype.bindEvent=function(t){var e=this,n=function(t){for(var n,r=t.type,o=t.target,i=!1;!i&&o;){if((n=e.getEvent(o))&&n===r){i=!0;break}o=o.parentNode}if(!0===i){h.d(pe,"#bindEvent - matched ".concat(r," eventType"));var a=e.getRequestParam(o);e.submit(e.parameterStore.replaceDynamicString(a))}};F("load",(function(){var e,r;for(e=0;e<t.length;e++)r=t[e],h.d(pe,"#bindEvent - addEventListener eventType: ".concat(r)),document.addEventListener(r,n,!1)}))},t}();if(!l.isSupported()){var Ae=void 0,Ie=function(){};for(Ae in Le.prototype)"function"==typeof Le.prototype[Ae]&&(Le.prototype[Ae]=Ie)}return new Le}));
//# sourceMappingURL=web-log.umd.min.js.map
